<patterndb version='4' pub_date='2014-03-03'>

<ruleset name='<%= @name -%>' id='<%= @id -%>'>
    <patterns>
<% @patterns.each do |prg_name| -%>
        <pattern><%= prg_name -%></pattern>
<% end -%>
    </patterns>
    <rules>
<% @rules.each do |rule| -%>
        <rule provider='<%= rule['provider'] || "puppet@"+@hostname -%>' id='<%= rule['id'] -%>'>
            <patterns>
<% rule['patterns'].each do |pattern| -%>
                <pattern><%= pattern -%></pattern>
<% end -%>
            </patterns>
<% if rule['tags'] -%>
            <tags>
<% rule['tags'].each do |tag| -%>
                <tag><%= tag -%></tag>
<% end -%>
            </tags>
<% end -%>
<% if rule['examples'] -%>
            <examples>
<% rule['examples'].each do |example| -%>
                <example>
                    <test_message program="<%= example['program'] -%>"><%= example['test_message'] -%></test_message>
                </example>
<% end -%>
            </examples>
<% end -%>
        </rule>
<% end -%>
    </rules>
</ruleset>

</patterndb>

<!-- vim:ft=xml:background=dark
     -->
